# ВОТ - Виртуализация и облачни технологии @ ТУЕС

***ЩЕ БЪДЕ ОПРАВЕНО ДЕКЕМВРИ (ВЕРОЯТНО)***

CloudBalkan

lyubomir.stoyanov@oblak.bg 

2 контролни на срок
2-ри срок по-важен

Модел записки :)

Диалогично 


Docker - имплементация на LXC - Linux Containers since 2x kernel based on cgroups and namespaces in the linux kernel 
Docker versioning - aka with containers with Git
Public and corporate versions 

виртуализация

----

Хипервайзор
Мултитаскинг – Разделяме времето, за което всеки процес използва процесора (дадени ресурси), 
Имплементацията на мултитаскинга опира до Кърнела.

Контрол групи в Кърнела – процесът се разглежда като изолиран обект, правим структура от данни, в която всеки един процес върви с конфигурация от това какво може да използва. Контрол групите помагат реализирането на мултитаскинга. 

Namespace – 
Мултитрединг – 
Зад тези концепции стои мултитаскингът.

Nested виртуализация

Хипервайзор тип 1 (native) -> липсва ОС и Кърнелът има функции само за виртуализация
Хипервайзор тип 2 -> на хоста има ОС

Виртуализация тип 1 – не изисква ОС на хоста
Виртуализация тип 2 – изисква ОС на хоста
(Пълна виртуализация, докато контейнеризацията е контейнеризация)

Латенция - Latency

Контейнър – друг тип виртуализация (пайтън virtual environment-а е бащата)
Кубернетис

Контейнеризация (docker) – Вместо BIOS имаме друга среда. Недостатък е, че на практика контейнерът не е ОС. Ако Кърнелът (на хоста) се счупи, всичко пада, защото на виртуалната машина няма кърнел. Контейнерът е по-бърз, защото е малък.



Записки от вкъщи:
В компютърната техника многозадачността (multitasking) е едновременното изпълнение на множество задачи (известни също като процеси) за определен период от време. Многозадачността автоматично прекъсва изпълняваната програма, запазва нейното състояние (частични резултати, съдържание на паметта и съдържанието на регистъра на компютъра) и зарежда запазеното състояние на друга програма и прехвърля контрола върху нея. Имплементацията на мултитаскинга опира до Кърнела.

Контролните групи, обикновено наричани cgroups, са Linux функция на ядрото, която позволява процесите да бъдат организирани в йерархични групи, чието използване на различни видове ресурси може след това да бъдат ограничени и наблюдавани. На практика контролните групи предоставят механизъм за агрегиране/разделяне на набори от задачи и всички техни бъдещи потомци в йерархични групи със специализирано поведение. Контрол групите помагат реализирането на мултитаскинга. 
Cgroups ви позволяват да разпределяте ресурси - като време на процесора, системна памет, честотна лента на мрежата или комбинации от тези ресурси - между дефинирани от потребителя групи от задачи (процеси), изпълнявани на система. Можете да наблюдавате cgroups, които конфигурирате, да отказвате cgroups достъп до определени ресурси и дори да преконфигурирате вашите cgroups динамично на работеща система. (RedHat)

Пространствата от имена (namespace) са функция на ядрото на Linux, която разделя ресурсите на ядрото, така че един набор от процеси вижда един набор от ресурси, докато друг набор от процеси вижда различен набор от ресурси. С други думи, ключовата характеристика на пространствата от имена е, че те изолират процесите един от друг.

Namespace-ът е група от cgroup-и.
Mногозадачността позволява на процесите да се изпълняват едновременно. По подобен начин многонишковостта позволява на подпроцеси (нишки) да се изпълняват едновременно или паралелно.
Процесът е програма, която се изпълнява. Процесът може да бъде допълнително разделен на независими единици, известни като нишки. Нишката е като малък лек процес в процеса. Или можем да кажем, че колекция от нишки е това, което е известно като процес.

Зад концепциите Namespace и Multi-threading стои мултитаскингът.
Съществува 2 типа виртуализация: Пълна виртуализация и контейнеризация.
Пълната виртуализация се дели на два типа: виртуализация тип 1, която не изисква ОС на хоста и виртуализация тип 2, която изисква ОС на хоста. Хипервайзор тип 1 работи директно върху хардуера, което означава, че не е необходима друга операционна система за стартиране на този тип. По този начин хипервайзорът има директен достъп до хардуера, без да се налага да преминава през ОС. Тип 2 хипервайзорът действа като софтуер за стартиране и управление на виртуални машини. Достъпът до хардуерния ресурс, необходим на виртуалната машина, трябва да преминава през ОС.

Процесът по контейнеризация представлява „опаковането“ на софтуер с всички технологични рамки, библиотеки и други елементи, които са необходими за функционирането на кода, в собствен контейнер. Целта на това е софтуерът или приложението, които се намират в контейнера, да могат да бъдат преместени върху инфраструктурата на друга операционна система или друга среда. Контейнерът е преносима среда, която осигурява независимостта на софтуера от инфраструктурата, върху която работи. Docker е пример за платформа за контейнеризиране.
Вместо BIOS имаме друга среда. Недостатък е, че на практика контейнерът не е ОС. Ако Кърнелът (на хоста) се счупи, всичко пада, защото на виртуалната машина няма кърнел. Контейнерът е по-бърз, защото е малък.

Виртуализацията поддържа изпълнението на множество операционни системи на един физически сървър, докато контейнеризацията поддържа внедряването на множество приложения, разработени в средата на една операционна система, разположена на една виртуална машина или сървър.






------

OSI модел:
7 слоя:
-	Физически -> кабели
-	Data Link -> MAC адреси (уникален е за всяко устройство)
-	Network -> IP адреси (имаме public и private)
Public -> Той е видим за цял свят (Пр.: 56.10.24.170 / 32)
Private -> Видим е за локалната мрежа (Пр.: 192.168.0.10 / 24)
IPv4 -> 32 bits
IPv6 -> 128 bits
-	Transport -> Протоколи (конвенция, инструкция за това как да се интерпретират нещата) TCP/UDP
TCP е по-сигурно от UDP, затова повечето Ddos атаките се правят с TCP. Smurf attack, Slow loris?
-	Session – Когато две устройства си говорят, те отварят два стека в паметта. Връзката между стековете е сесия
-	Presentation -> Ориентираме се какво е съдържанието на файла по неговото разширение (но това е, когато е на хард диска). На този слой се използва mime type. Казваме на практика какво предаваме, пращаме.
-	Application -> HTTP(s) – протоколи за предаване на данни на ниво приложение; навигира как да работи с информацията
-	
Какво е рутерът?
Има комуникационни модули, RAM и процесор + софтуер (фърмуер)

Какво ще стане, ако виртуализираме рутер?
С него ще може да направим виртуална мрежа – VLAN. За VLAN мрежата важат всички правила, които важат и за LAN. 

Host
VLAN
VM
LAN карта (шлюз, gateway на виртуалната мрежа) -> 

L2 routing table -> рутиране по мак адреси
L4 -> по IP
L7 -> по URL

За виртуалните машини е необходима виртуална мрежа, защото няма как физически да бъде свързана. Виртуалните машини могат да комуникират само във виртуалната мрежа.


OSI модел:
7 слоя:
-    Физически -> кабели
-    Data Link -> MAC адреси (уникален е за всяко устройство)
-    Network -> IP адреси (имаме public и private)
Public -> Той е видим за цял свят (Пр.: 56.10.24.170 / 32)
Private -> Видим е за локалната мрежа (Пр.: 192.168.0.10 / 24)
IPv4 -> 32 bits
IPv6 -> 128 bits
-    Transport (TCP/UDP) -> конвенция как да се интерпретира инфото 
- TCP -> надежно, с TCP Handshake, по-висока латентност 
Slow Loris, Smurf
-    Session -> Session Key
-    Presentation -> определяне на тип данни – mime type 
-    Application -> http(s), (s)ftp, ssh, ..

---

Storage-и:

Storage технологии (3 типа):
-	File storage
-	Block storage
-	Object storage

Как се съхраняват данните на хард диска?
Записват се поредица от байтове. Разделени се на сектори.
Block Size – твърде неефективно, ако се записват всички битове на един файл, затова се въвежда организация. Физическата организация е на сектори, а логическата на блокове. Идеята е да се прочетат краен брой блокове наведнъж. Целта е бързодействие. ОС (файловата система) определя block size-а и кое къде се пише.
Файлови системи:
-	EXT?
-	NTFS?

Когато искаме да записваме файловете отдалечено (remotely), има няколко начина:

File sharing?

File storage:
Client1 (OS)
                 | /photos
Server 2 <- Server1 (OS) -> c:\photos
	   |
1		2

Файловата система се определя от сървъра? За да постигнем петабайтове, навръзваме хард дискове с размери терабайтове, но използвайки различни сървъри. Когато имаме консолидиране сървъри, можем да запазваме файловете на части в различните сървъри (Високо-сигурни storage-и).

Протоколи, които предоставят подобен механизъм:
-	SMB – позволява консолидация на повече от един сървър
-	SAMBA
-	FTP
-	SFTP

Как да пишем директно на хард диска от remote устройство?

Когато пишем блокове, най-малката единица, която можем да запишем е един блок.
Необходимата информация на ОС да запише един блок е:
-	Адрес
-	Данни

Block storage – exposeване на блокове. Най-видният представител е iSCSI. Клиентът вече определя кой къде ще се запише?? Недостатък: ако два процеса пишат и четат едновременно на едно и също адресно пространство, ще се corruptнат файловете. Затова имаме следното условие: клиентът трябва да е само един.

Тези два типа storage- са конвенционални.

Когато съхраняваме данни, искаме:
-	Бърз достъп
-	Лесен достъп

Хеш Таблицата е структура, която може да осигури това. Сървъра съхранява тази таблица. 
GET, POST, PUT, DELETE, HEAD, …
|
Header
Metadata					CRUD операции
Data
…
|
HTTP



Key: 		Value:
URL (HTTP)		File

Максималната големина на path е 255. За всеки файл той е уникален. URL е еквивалентно на path-а само че в Интернет.

Това нещо се нарича Object storage. Най-виден представител е S3. Друг представител е CEPH.


----

Източници: 
Части от лекция 1, 2 и 3 - Кристиян Богданов
